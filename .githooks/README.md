# Git Hooks - Automated Documentation

This directory contains git hooks for automated documentation generation and validation.

---

## ðŸš€ Installation

Enable these hooks in your project:

```bash
# One-time setup
git config core.hooksPath .githooks
chmod +x .githooks/*  # Mac/Linux only
```

---

## ðŸ“‹ Available Hooks

### pre-commit

**Runs before each commit to validate:**
- âœ… No unreplaced placeholders (`{{...}}`)
- âœ… No `.env.local` files being committed
- âœ… Markdown syntax (if markdownlint installed)

**When it fails:**
- Fix the issues reported
- Re-stage your files
- Try commit again

### commit-msg

**Validates commit message format:**
- âœ… Must follow conventional commits: `<type>(<scope>): <description>`
- âœ… Valid types: `feat`, `fix`, `docs`, `style`, `refactor`, `perf`, `test`, `build`, `ci`, `chore`

**Examples:**
```bash
git commit -m "feat(auth): add OAuth login"
git commit -m "fix(api): resolve timeout error"
git commit -m "docs: update README"
```

### post-commit

**Optionally auto-generates documentation after each commit:**
- Session documentation (from recent changes)
- Changelog updates (from conventional commits)

**Enable auto-documentation:**

Create `.git/hooks-config`:
```bash
# Enable session doc auto-generation
AUTO_SESSION_DOC=true

# Enable changelog auto-generation
AUTO_CHANGELOG=true
```

---

## ðŸ”§ Configuration

### Enable Auto-Documentation

```bash
# Create hooks config
cat > .git/hooks-config << EOF
AUTO_SESSION_DOC=true
AUTO_CHANGELOG=true
EOF
```

### Disable Specific Hooks

```bash
# Temporarily bypass hooks (not recommended)
git commit --no-verify -m "commit message"

# Disable permanently
git config core.hooksPath ""  # Revert to default hooks
```

---

## ðŸ“– Manual Documentation Scripts

**You can also run documentation scripts manually:**

### Generate Session Documentation

```bash
# Auto-generate from last 24 hours of changes
python C:/devop/.template-system/scripts/generate_session_doc.py \
  --project-path $(pwd)

# Interactive mode (prompts for details)
python C:/devop/.template-system/scripts/generate_session_doc.py \
  --project-path $(pwd) \
  --interactive

# Custom time range
python C:/devop/.template-system/scripts/generate_session_doc.py \
  --project-path $(pwd) \
  --since-hours 8
```

### Generate Changelog

```bash
# Generate changelog for unreleased changes
python C:/devop/.template-system/scripts/generate_changelog.py \
  --project-path $(pwd) \
  --unreleased

# Generate changelog for specific version
python C:/devop/.template-system/scripts/generate_changelog.py \
  --project-path $(pwd) \
  --version v1.0.0
```

---

## ðŸŽ¯ Workflow Integration

### Typical Daily Workflow

```bash
# 1. Make changes to code/docs
# ... edit files ...

# 2. Stage changes
git add .

# 3. Commit (hooks run automatically)
git commit -m "feat(feature): add new functionality"
#   âœ… pre-commit: validates no placeholders, no secrets
#   âœ… commit-msg: validates conventional commit format
#   âœ… post-commit: generates session doc (if enabled)

# 4. Push to remote
git push origin master
```

### End of Sprint Workflow

```bash
# 1. Generate final session doc for sprint
python C:/devop/.template-system/scripts/generate_session_doc.py \
  --project-path $(pwd) \
  --interactive

# 2. Generate changelog for release
python C:/devop/.template-system/scripts/generate_changelog.py \
  --project-path $(pwd) \
  --version v1.0.0

# 3. Review generated docs
# 4. Commit and tag release
git add CHANGELOG.md docs/progress/
git commit -m "docs: update changelog and session docs for v1.0.0"
git tag -a v1.0.0 -m "Release version 1.0.0"
git push origin master --tags
```

---

## ðŸ“ Documentation Templates

These hooks work with the following documentation templates:

| Template | Location | Generated By |
|----------|----------|--------------|
| Session Progress | `docs/progress/SESSION-YYYY-MM-DD.md` | `generate_session_doc.py` |
| Changelog | `CHANGELOG.md` | `generate_changelog.py` |
| Sprint Summary | `sprints/SPRINT-NN-summary.md` | Manual (template in `sprints/`) |

---

## ðŸ› Troubleshooting

### Hook not running

```bash
# Verify hooks are enabled
git config core.hooksPath
# Should show: .githooks

# Re-enable if needed
git config core.hooksPath .githooks
```

### Permission denied (Mac/Linux)

```bash
# Make hooks executable
chmod +x .githooks/*
```

### Python script not found

```bash
# Verify script exists
ls -la C:/devop/.template-system/scripts/

# Run manually to test
python C:/devop/.template-system/scripts/generate_session_doc.py --help
```

### Commit blocked by validation

**Read the error message carefully.** Common issues:

1. **Unreplaced placeholders**: Search for `{{` and replace with actual values
2. **Invalid commit message**: Use format `type(scope): description`
3. **Secret file**: Don't commit `.env.local` - it's in `.gitignore`

---

## ðŸ”— References

- **Conventional Commits:** https://www.conventionalcommits.org/
- **Keep a Changelog:** https://keepachangelog.com/
- **Git Hooks:** https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks
- **Documentation Guide:** `DOCUMENTATION-GUIDELINES.md`
- **Style Guide:** `STYLE-GUIDE.md`

---

**Version:** 1.0
**Last Updated:** 2025-11-02
